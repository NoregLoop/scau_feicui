{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, normalizeStyle as _normalizeStyle, withCtx as _withCtx, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"template\", {\n  slot: \"title\"\n}, [/*#__PURE__*/_createTextVNode(\"更多菜单\")], -1 /* HOISTED */);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_svg_icon = _resolveComponent(\"svg-icon\");\n  const _component_el_menu_item = _resolveComponent(\"el-menu-item\");\n  const _component_el_submenu = _resolveComponent(\"el-submenu\");\n  const _component_el_menu = _resolveComponent(\"el-menu\");\n  return _openBlock(), _createBlock(_component_el_menu, {\n    \"default-active\": $options.activeMenu,\n    mode: \"horizontal\",\n    onSelect: $options.handleSelect\n  }, {\n    default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($options.topMenus, (item, index) => {\n      return _openBlock(), _createElementBlock(_Fragment, null, [index < $data.visibleNumber ? (_openBlock(), _createBlock(_component_el_menu_item, {\n        style: _normalizeStyle({\n          '--theme': $options.theme\n        }),\n        index: item.path,\n        key: index\n      }, {\n        default: _withCtx(() => [_createVNode(_component_svg_icon, {\n          \"icon-class\": item.meta.icon\n        }, null, 8 /* PROPS */, [\"icon-class\"]), _createTextVNode(\" \" + _toDisplayString(item.meta.title), 1 /* TEXT */)]),\n\n        _: 2 /* DYNAMIC */\n      }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"style\", \"index\"])) : _createCommentVNode(\"v-if\", true)], 64 /* STABLE_FRAGMENT */);\n    }), 256 /* UNKEYED_FRAGMENT */)), _createCommentVNode(\" 顶部菜单超出数量折叠 \"), $options.topMenus.length > $data.visibleNumber ? (_openBlock(), _createBlock(_component_el_submenu, {\n      key: 0,\n      style: _normalizeStyle({\n        '--theme': $options.theme\n      }),\n      index: \"more\"\n    }, {\n      default: _withCtx(() => [_hoisted_1, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($options.topMenus, (item, index) => {\n        return _openBlock(), _createElementBlock(_Fragment, null, [index >= $data.visibleNumber ? (_openBlock(), _createBlock(_component_el_menu_item, {\n          index: item.path,\n          key: index\n        }, {\n          default: _withCtx(() => [_createVNode(_component_svg_icon, {\n            \"icon-class\": item.meta.icon\n          }, null, 8 /* PROPS */, [\"icon-class\"]), _createTextVNode(\" \" + _toDisplayString(item.meta.title), 1 /* TEXT */)]),\n\n          _: 2 /* DYNAMIC */\n        }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"index\"])) : _createCommentVNode(\"v-if\", true)], 64 /* STABLE_FRAGMENT */);\n      }), 256 /* UNKEYED_FRAGMENT */))]),\n\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"style\"])) : _createCommentVNode(\"v-if\", true)]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"default-active\", \"onSelect\"]);\n}","map":{"version":3,"names":["_createElementVNode","slot","_createBlock","_component_el_menu","$options","activeMenu","mode","onSelect","handleSelect","_createElementBlock","_Fragment","_renderList","topMenus","item","index","$data","visibleNumber","_component_el_menu_item","style","_normalizeStyle","theme","path","key","_createVNode","_component_svg_icon","meta","icon","_toDisplayString","title","_createCommentVNode","length","_component_el_submenu","_hoisted_1"],"sources":["D:\\devprojects\\VsProjects\\Tobacco\\tobacco\\src\\components\\TopNav\\index.vue"],"sourcesContent":["<template>\n  <el-menu\n    :default-active=\"activeMenu\"\n    mode=\"horizontal\"\n    @select=\"handleSelect\"\n  >\n    <template v-for=\"(item, index) in topMenus\">\n      <el-menu-item :style=\"{'--theme': theme}\" :index=\"item.path\" :key=\"index\" v-if=\"index < visibleNumber\"\n        ><svg-icon :icon-class=\"item.meta.icon\" />\n        {{ item.meta.title }}</el-menu-item\n      >\n    </template>\n\n    <!-- 顶部菜单超出数量折叠 -->\n    <el-submenu :style=\"{'--theme': theme}\" index=\"more\" v-if=\"topMenus.length > visibleNumber\">\n      <template slot=\"title\">更多菜单</template>\n      <template v-for=\"(item, index) in topMenus\">\n        <el-menu-item\n          :index=\"item.path\"\n          :key=\"index\"\n          v-if=\"index >= visibleNumber\"\n          ><svg-icon :icon-class=\"item.meta.icon\" />\n          {{ item.meta.title }}</el-menu-item\n        >\n      </template>\n    </el-submenu>\n  </el-menu>\n</template>\n\n<script>\nimport { constantRoutes } from \"@/router\";\n\n// 隐藏侧边栏路由\nconst hideList = ['/index', '/user/profile'];\n\nexport default {\n  data() {\n    return {\n      // 顶部栏初始数\n      visibleNumber: 5,\n      // 当前激活菜单的 index\n      currentIndex: undefined\n    };\n  },\n  computed: {\n    theme() {\n      return this.$store.state.settings.theme;\n    },\n    // 顶部显示菜单\n    topMenus() {\n      let topMenus = [];\n      this.routers.map((menu) => {\n        if (menu.hidden !== true) {\n          // 兼容顶部栏一级菜单内部跳转\n          if (menu.path === \"/\") {\n              topMenus.push(menu.children[0]);\n          } else {\n              topMenus.push(menu);\n          }\n        }\n      });\n      return topMenus;\n    },\n    // 所有的路由信息\n    routers() {\n      return this.$store.state.permission.topbarRouters;\n    },\n    // 设置子路由\n    childrenMenus() {\n      var childrenMenus = [];\n      this.routers.map((router) => {\n        for (var item in router.children) {\n          if (router.children[item].parentPath === undefined) {\n            if(router.path === \"/\") {\n              router.children[item].path = \"/\" + router.children[item].path;\n            } else {\n              if(!this.ishttp(router.children[item].path)) {\n                router.children[item].path = router.path + \"/\" + router.children[item].path;\n              }\n            }\n            router.children[item].parentPath = router.path;\n          }\n          childrenMenus.push(router.children[item]);\n        }\n      });\n      return constantRoutes.concat(childrenMenus);\n    },\n    // 默认激活的菜单\n    activeMenu() {\n      const path = this.$route.path;\n      let activePath = path;\n      if (path !== undefined && path.lastIndexOf(\"/\") > 0 && hideList.indexOf(path) === -1) {\n        const tmpPath = path.substring(1, path.length);\n        activePath = \"/\" + tmpPath.substring(0, tmpPath.indexOf(\"/\"));\n        if (!this.$route.meta.link) {\n          this.$store.dispatch('app/toggleSideBarHide', false);\n        }\n      } else if(!this.$route.children) {\n        activePath = path;\n        this.$store.dispatch('app/toggleSideBarHide', true);\n      }\n      this.activeRoutes(activePath);\n      return activePath;\n    },\n  },\n  beforeMount() {\n    window.addEventListener('resize', this.setVisibleNumber)\n  },\n  beforeDestroy() {\n    window.removeEventListener('resize', this.setVisibleNumber)\n  },\n  mounted() {\n    this.setVisibleNumber();\n  },\n  methods: {\n    // 根据宽度计算设置显示栏数\n    setVisibleNumber() {\n      const width = document.body.getBoundingClientRect().width / 3;\n      this.visibleNumber = parseInt(width / 85);\n    },\n    // 菜单选择事件\n    handleSelect(key, keyPath) {\n      this.currentIndex = key;\n      const route = this.routers.find(item => item.path === key);\n      if (this.ishttp(key)) {\n        // http(s):// 路径新窗口打开\n        window.open(key, \"_blank\");\n      } else if (!route || !route.children) {\n        // 没有子路由路径内部打开\n        const routeMenu = this.childrenMenus.find(item => item.path === key);\n        if (routeMenu && routeMenu.query) {\n          let query = JSON.parse(routeMenu.query);\n          this.$router.push({ path: key, query: query });\n        } else {\n          this.$router.push({ path: key });\n        }\n        this.$store.dispatch('app/toggleSideBarHide', true);\n      } else {\n        // 显示左侧联动菜单\n        this.activeRoutes(key);\n        this.$store.dispatch('app/toggleSideBarHide', false);\n      }\n    },\n    // 当前激活的路由\n    activeRoutes(key) {\n      var routes = [];\n      if (this.childrenMenus && this.childrenMenus.length > 0) {\n        this.childrenMenus.map((item) => {\n          if (key == item.parentPath || (key == \"index\" && \"\" == item.path)) {\n            routes.push(item);\n          }\n        });\n      }\n      if(routes.length > 0) {\n        this.$store.commit(\"SET_SIDEBAR_ROUTERS\", routes);\n      } else {\n        this.$store.dispatch('app/toggleSideBarHide', true);\n      }\n    },\n    ishttp(url) {\n      return url.indexOf('http://') !== -1 || url.indexOf('https://') !== -1\n    }\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.topmenu-container.el-menu--horizontal > .el-menu-item {\n  float: left;\n  height: 50px !important;\n  line-height: 50px !important;\n  color: #999093 !important;\n  padding: 0 5px !important;\n  margin: 0 10px !important;\n}\n\n.topmenu-container.el-menu--horizontal > .el-menu-item.is-active, .el-menu--horizontal > .el-submenu.is-active .el-submenu__title {\n  border-bottom: 2px solid #{'var(--theme)'} !important;\n  color: #303133;\n}\n\n/* submenu item */\n.topmenu-container.el-menu--horizontal > .el-submenu .el-submenu__title {\n  float: left;\n  height: 50px !important;\n  line-height: 50px !important;\n  color: #999093 !important;\n  padding: 0 5px !important;\n  margin: 0 10px !important;\n}\n</style>\n"],"mappings":";gCAeMA,mBAAA,CAAsC;EAA5BC,IAAI,EAAC;AAAO,I,8BAAC,MAAI,E;;;;;;;uBAd/BC,YAAA,CAyBUC,kBAAA;IAxBP,gBAAc,EAAEC,QAAA,CAAAC,UAAU;IAC3BC,IAAI,EAAC,YAAY;IAChBC,QAAM,EAAEH,QAAA,CAAAI;;sBAEC,MAAiC,E,kBAA3CC,mBAAA,CAKWC,SAAA,QAAAC,WAAA,CALuBP,QAAA,CAAAQ,QAAQ,GAAxBC,IAAI,EAAEC,KAAK;iEACqDA,KAAK,GAAGC,KAAA,CAAAC,aAAa,I,cAArGd,YAAA,CAGCe,uBAAA;QAHcC,KAAK,EAAAC,eAAA;UAAA,WAAcf,QAAA,CAAAgB;QAAK;QAAIN,KAAK,EAAED,IAAI,CAACQ,IAAI;QAAGC,GAAG,EAAER;;0BAChE,MAAyC,CAAzCS,YAAA,CAAyCC,mBAAA;UAA9B,YAAU,EAAEX,IAAI,CAACY,IAAI,CAACC;kEAAQ,GAC1C,GAAAC,gBAAA,CAAGd,IAAI,CAACY,IAAI,CAACG,KAAK,iB;;;;sCAItBC,mBAAA,gBAAmB,EACwCzB,QAAA,CAAAQ,QAAQ,CAACkB,MAAM,GAAGf,KAAA,CAAAC,aAAa,I,cAA1Fd,YAAA,CAWa6B,qBAAA;;MAXAb,KAAK,EAAAC,eAAA;QAAA,WAAcf,QAAA,CAAAgB;MAAK;MAAGN,KAAK,EAAC;;wBAC5C,MAAsC,CAAtCkB,UAAsC,G,kBACtCvB,mBAAA,CAQWC,SAAA,QAAAC,WAAA,CARuBP,QAAA,CAAAQ,QAAQ,GAAxBC,IAAI,EAAEC,KAAK;mEAInBA,KAAK,IAAIC,KAAA,CAAAC,aAAa,I,cAH9Bd,YAAA,CAMCe,uBAAA;UALEH,KAAK,EAAED,IAAI,CAACQ,IAAI;UAChBC,GAAG,EAAER;;4BAEL,MAAyC,CAAzCS,YAAA,CAAyCC,mBAAA;YAA9B,YAAU,EAAEX,IAAI,CAACY,IAAI,CAACC;oEAAQ,GAC1C,GAAAC,gBAAA,CAAGd,IAAI,CAACY,IAAI,CAACG,KAAK,iB"},"metadata":{},"sourceType":"module","externalDependencies":[]}