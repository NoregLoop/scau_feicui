"use strict";(self["webpackChunkERP"]=self["webpackChunkERP"]||[]).push([[552],{9552:function(e,o,r){r.r(o),r.d(o,{default:function(){return v}});var t=r(3396),i=r(3862);const l={style:{height:"100%"}},s={class:"front-login"},a=(0,t._)("h3",{class:"title"},"翡翠ERP系统",-1),n={key:0,style:{float:"left","margin-top":"3px","margin-left":"30px"}},m={key:0},d={key:1},u=(0,t._)("div",{class:"el-login-footer"},[(0,t._)("span",null,"Copyright © 2023 SCAU-404.")],-1);function g(e,o,r,g,p,c){const h=(0,t.up)("svg-icon"),f=(0,t.up)("el-input"),w=(0,t.up)("el-form-item"),b=(0,t.up)("el-checkbox"),F=(0,t.up)("router-link"),k=(0,t.up)("el-button"),v=(0,t.up)("el-form");return(0,t.wg)(),(0,t.iD)("div",l,[(0,t._)("div",s,[(0,t.Wm)(v,{ref:"loginForm",model:p.loginForm,rules:p.loginRules,class:"login-form"},{default:(0,t.w5)((()=>[a,(0,t.Wm)(w,{prop:"username"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:p.loginForm.username,"onUpdate:modelValue":o[0]||(o[0]=e=>p.loginForm.username=e),type:"text","auto-complete":"off",placeholder:"账号"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{slot:"prefix","icon-class":"user",class:"el-input__icon input-icon"})])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(w,{prop:"password"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:p.loginForm.password,"onUpdate:modelValue":o[1]||(o[1]=e=>p.loginForm.password=e),type:"password","auto-complete":"off",placeholder:"密码",onKeyup:o[2]||(o[2]=(0,i.D2)((()=>{}),["enter","native"]))},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{slot:"prefix","icon-class":"password",class:"el-input__icon input-icon"})])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(b,{modelValue:p.loginForm.rememberMe,"onUpdate:modelValue":o[3]||(o[3]=e=>p.loginForm.rememberMe=e),style:{float:"left","margin-left":"120px"}},{default:(0,t.w5)((()=>[(0,t.Uk)("记住密码")])),_:1},8,["modelValue"]),p.register?((0,t.wg)(),(0,t.iD)("div",n,[(0,t.Wm)(F,{class:"link-type",to:"/register"},{default:(0,t.w5)((()=>[(0,t.Uk)("立即注册")])),_:1})])):(0,t.kq)("",!0),(0,t.Wm)(w,{style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{loading:p.loading,size:"medium",type:"primary",style:{width:"100%"},onClick:(0,i.iM)(c.handleLogin,["prevent"])},{default:(0,t.w5)((()=>[p.loading?((0,t.wg)(),(0,t.iD)("span",d,"登 录 中...")):((0,t.wg)(),(0,t.iD)("span",m,"登 录"))])),_:1},8,["loading","onClick"])])),_:1})])),_:1},8,["model","rules"]),u])])}r(7658);var p=r(2223),c=r(680),h=r(1120),f=r(1051),w=r(7178),b={name:"Login",data(){return{codeUrl:"",loginForm:{username:"",password:"",rememberMe:!1},loginRules:{username:[{required:!0,trigger:"blur",message:"请输入您的账号"}],password:[{required:!0,trigger:"blur",message:"请输入您的密码"}],code:[{required:!0,trigger:"change",message:"请输入验证码"}]},loading:!1,captchaEnabled:!0,register:!0,redirect:void 0}},watch:{$route:{handler:function(e){this.redirect=e.query&&e.query.redirect},immediate:!0}},created(){this.getCookie()},methods:{getCode(){getCodeImg().then((e=>{this.captchaEnabled=void 0===e.captchaEnabled||e.captchaEnabled,this.captchaEnabled&&(this.codeUrl="data:image/gif;base64,"+e.img,this.loginForm.uuid=e.uuid)}))},getCookie(){const e=c.Z.get("username"),o=c.Z.get("password"),r=c.Z.get("rememberMe");this.loginForm={username:void 0===e?this.loginForm.username:e,password:void 0===o?this.loginForm.password:(0,f.p)(o),rememberMe:void 0!==r&&Boolean(r)}},handleLogin(){this.$refs.loginForm.validate((e=>{e&&(this.loading=!0,this.loginForm.rememberMe?(c.Z.set("username",this.loginForm.username,{expires:30}),c.Z.set("password",(0,f.H)(this.loginForm.password),{expires:30}),c.Z.set("rememberMe",this.loginForm.rememberMe,{expires:30})):(c.Z.remove("username"),c.Z.remove("password"),c.Z.remove("rememberMe")),(0,p.x4)(this.loginForm).then((e=>{"200"==e.code?(c.Z.set("User-Token",e.token),(0,p.C5)().then((e=>{(0,p.NF)().then((e=>{c.Z.set("isLogin",!0,Boolean),(0,h.cg)(e.data),this.$router.push({path:"/inbound/action"})}))}))):((0,w.z8)({message:e.msg,type:"error"}),this.loading=!1)})).catch((e=>{this.loading=!1})))}))}}},F=r(89);const k=(0,F.Z)(b,[["render",g]]);var v=k}}]);
//# sourceMappingURL=552.1cfc992c.js.map