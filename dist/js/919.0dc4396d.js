"use strict";(self["webpackChunkERP"]=self["webpackChunkERP"]||[]).push([[919],{5541:function(e,a,l){l.d(a,{B7:function(){return u},Bc:function(){return n},OE:function(){return o},Qf:function(){return d},Sp:function(){return r},Yp:function(){return m},eN:function(){return i},iF:function(){return s},lE:function(){return c}});var t=l(2334);function i(e){return(0,t.Z)({url:"/system/outboundOrder",headers:{isToken:!0},method:"post",data:e})}function r(e){return(0,t.Z)({url:"/system/jade",headers:{isToken:!0},data:e,method:"put"})}function o(){return(0,t.Z)({url:"/system/outboundOrder/getOutboundOrderCode",headers:{isToken:!0},method:"get"})}function d(e,a,l,i,r){return(0,t.Z)({url:"/system/outboundOrder/list",headers:{isToken:!0},params:{pageNum:e,pageSize:a,orderCode:l,supplierId:i,desWarehouseId:r},method:"get"})}function n(e){return(0,t.Z)({url:"/api/image/crop",headers:{isToken:!0},data:e,method:"post"})}function s(e){return(0,t.Z)({url:"/system/jadeFeature/match",headers:{isToken:!0},data:e,method:"post"})}function u(e){return(0,t.Z)({url:"/api/image/feature",headers:{isToken:!0},data:e,method:"post"})}function m(e){return(0,t.Z)({url:"/system/jade/list",headers:{isToken:!0},params:{imageId:e},method:"get"})}function c(e,a){return(0,t.Z)({url:"/system/user/list",headers:{isToken:!0},method:"get",params:{pageNum:e,pageSize:a}})}},3919:function(e,a,l){l.r(a),l.d(a,{default:function(){return H}});var t=l(3396),i=l(7139),r=l(5941);const o=e=>((0,t.dD)("data-v-61a42903"),e=e(),(0,t.Cn)(),e),d={class:"front"},n={class:"front-left"},s={class:"front-right"},u={class:"right-photo"},m={key:0,ref:"videoElement",class:"rigth-video",autoplay:""},c={ref:"canvasElement",class:"right-img"},p={class:"right-action"},h={class:"tail"},w={class:"tail-action"},g=o((()=>(0,t._)("div",{class:"no-data"},"暂无数据",-1))),f={class:"pagination"},v={class:"optionView"},b={class:"image-miss"},_=o((()=>(0,t._)("div",null,"请勾选对象然后选择确认",-1)));function W(e,a,l,o,W,k){const y=(0,t.up)("el-input"),C=(0,t.up)("el-form-item"),U=(0,t.up)("el-option"),z=(0,t.up)("el-select"),S=(0,t.up)("el-button"),x=(0,t.up)("el-form"),D=(0,t.up)("el-upload"),V=(0,t.up)("el-image"),j=(0,t.up)("el-table-column"),H=(0,t.up)("el-checkbox"),I=(0,t.up)("el-checkbox-group"),P=(0,t.up)("el-popover"),F=(0,t.up)("el-table"),T=(0,t.up)("el-pagination"),E=(0,t.up)("el-descriptions-item"),Z=(0,t.up)("el-tag"),O=(0,t.up)("el-descriptions"),B=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("div",d,[(0,t._)("div",n,[(0,t.Wm)(x,{class:"front-form",model:e.searchForm,ref:"inventoryRef",rules:e.inventoryOrderRules,"label-width":"120px"},{default:(0,t.w5)((()=>[(0,t.Wm)(C,{label:"货品条码",class:"front-input"},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{modelValue:e.searchForm.jadeCode,"onUpdate:modelValue":a[0]||(a[0]=a=>e.searchForm.jadeCode=a)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(C,{label:"所属仓库",class:"front-input"},{default:(0,t.w5)((()=>[(0,t.Wm)(z,{modelValue:e.searchForm.storeNo,"onUpdate:modelValue":a[1]||(a[1]=a=>e.searchForm.storeNo=a),placeholder:"所属仓库"},{default:(0,t.w5)((()=>[(0,t.Wm)(U,{label:"Zone one",value:"shanghai"}),(0,t.Wm)(U,{label:"Zone two",value:"beijing"})])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(C,{label:"供应商",class:"front-input"},{default:(0,t.w5)((()=>[(0,t.Wm)(z,{modelValue:e.searchForm.supplier,"onUpdate:modelValue":a[2]||(a[2]=a=>e.searchForm.supplier=a),placeholder:"供应商"},{default:(0,t.w5)((()=>[(0,t.Wm)(U,{label:"Zone one",value:"shanghai"}),(0,t.Wm)(U,{label:"Zone two",value:"beijing"})])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(C,null,{default:(0,t.w5)((()=>[(0,t.Wm)(S,{type:"primary",onClick:a[3]||(a[3]=()=>{})},{default:(0,t.w5)((()=>[(0,t.Uk)("查询")])),_:1})])),_:1})])),_:1},8,["model","rules"])]),(0,t._)("div",s,[(0,t._)("div",u,[e.isvideo?((0,t.wg)(),(0,t.iD)("video",m,null,512)):(0,t.kq)("",!0),(0,t._)("canvas",c,null,512)]),(0,t._)("div",p,[(0,t.Wm)(D,{action:"http://47.106.116.146:8080/common/uploadImage",class:"upload",headers:{Authorization:e.token},"show-file-list":!1,accept:".png,.jpg,.jpeg,.webp",style:{display:"inline-block"},name:e.file,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"on-error":r.log(e.error),"on-success":e.handleUpload},{default:(0,t.w5)((()=>[(0,t.Wm)(S,{onClick:e.uploadImg,style:{color:"#1890ff"}},{default:(0,t.w5)((()=>[(0,t.Uk)("上传")])),_:1},8,["onClick"])])),_:1},8,["headers","name","on-preview","on-remove","on-error","on-success"]),(0,t.Wm)(S,{onClick:e.takePhoto,style:{color:"#1890ff","margin-left":"10px"}},{default:(0,t.w5)((()=>[(0,t.Uk)("拍照")])),_:1},8,["onClick"]),(0,t.Wm)(S,{onClick:e.triggerCamera,style:{color:"#1890ff"}},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.cameraActive?"关闭摄像头":"打开摄像头"),1)])),_:1},8,["onClick"])])])]),(0,t._)("div",h,[(0,t._)("div",w,[(0,t.Wm)(S,{type:"primary"},{default:(0,t.w5)((()=>[(0,t.Uk)("导出明细")])),_:1}),(0,t.Wm)(S,{type:"primary"},{default:(0,t.w5)((()=>[(0,t.Uk)("打印明细")])),_:1})]),(0,t.Wm)(F,{data:e.tableData(),border:"",style:{width:"100%"},"max-height":"350"},{empty:(0,t.w5)((()=>[g])),default:(0,t.w5)((()=>[(0,t.Wm)(j,{label:"货品图片",width:"90"},{default:(0,t.w5)((a=>[(0,t.Wm)(V,{src:"http://47.106.116.146:8080/profile"+a.row.imageUrl,fit:"contain",style:{"max-height":"50px","max-width":"30px"},"preview-teleported":!0,lazy:!0,"preview-src-list":e.imgPreview,onClick:l=>e.previewSrcList(a.row.imageUrl)},null,8,["src","preview-src-list","onClick"])])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.inventoryJadeDataColumn.data,(e=>((0,t.wg)(),(0,t.j4)(j,{prop:e.prop,"min-width":e.minWidth,width:e.width,"max-width":e.maxWidth,label:e.label},null,8,["prop","min-width","width","max-width","label"])))),256)),(0,t.Wm)(j,{width:"100px"},{header:(0,t.w5)((()=>[(0,t.Wm)(P,{placement:"bottom",trigger:"click"},{reference:(0,t.w5)((()=>[(0,t.Wm)(S,{size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("显示设置")])),_:1})])),default:(0,t.w5)((()=>[(0,t.Wm)(I,{modelValue:e.selectedFilters.data,"onUpdate:modelValue":a[4]||(a[4]=a=>e.selectedFilters.data=a)},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.tableFilter.data,(a=>((0,t.wg)(),(0,t.j4)(H,{label:a.label,onChange:e.filterColumns,disabled:a.isdisabled},null,8,["label","onChange","disabled"])))),256))])),_:1},8,["modelValue"])])),_:1})])),default:(0,t.w5)((()=>[(0,t.Wm)(S,{link:"",type:"primary",size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("查看明细")])),_:1}),(0,t.Wm)(S,{link:"",type:"primary",size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("编辑备注")])),_:1}),(0,t.Wm)(S,{link:"",type:"primary",size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:1})])),_:1})])),_:1},8,["data"]),(0,t._)("div",f,[(0,t.Wm)(T,{"current-page":e.data.page,"onUpdate:currentPage":a[5]||(a[5]=a=>e.data.page=a),"page-size":e.data.limit,"onUpdate:pageSize":a[6]||(a[6]=a=>e.data.limit=a),layout:"prev, pager, next ,total,sizes",total:e.data.total,onCurrentChange:e.handleCurrentChange,onSizeChange:e.handleSizeChange},null,8,["current-page","page-size","total","onCurrentChange","onSizeChange"])])]),(0,t._)("div",v,[(0,t.Wm)(B,{modelValue:e.dialogVisibleDetails,"onUpdate:modelValue":a[7]||(a[7]=a=>e.dialogVisibleDetails=a)},{default:(0,t.w5)((()=>[(0,t.Wm)(O,{border:"",size:"large",direction:"vertical",title:"排班基本信息"},{default:(0,t.w5)((()=>[(0,t.Wm)(E,{label:"直播店铺"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.rowDetails.streamPlatform),1)])),_:1}),(0,t.Wm)(E,{label:"代购费"},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,{size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("50")])),_:1})])),_:1}),(0,t.Wm)(E,{label:"直播班次"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.rowDetails.streamShift),1)])),_:1}),(0,t.Wm)(E,{label:"播货开始时间"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.rowDetails.startTime),1)])),_:1}),(0,t.Wm)(E,{label:"播货结束时间"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.rowDetails.endTime),1)])),_:1}),(0,t.Wm)(E,{label:"扣点比例"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.rowDetails.deductionPoints),1)])),_:1}),(0,t.Wm)(E,{label:"添加时间"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.rowDetails.createTime),1)])),_:1}),(0,t.Wm)(E,{label:"添加人"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.rowDetails.createBy),1)])),_:1}),(0,t.Wm)(E,{label:"修改时间"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.rowDetails.updateTime),1)])),_:1}),(0,t.Wm)(E,{label:"修改人"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.rowDetails.updateBy),1)])),_:1})])),_:1}),(0,t.Wm)(O,{border:"",size:"large",direction:"vertical",title:"直播人员信息",style:{"margin-top":"50px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(E,{label:"售前客服"},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,{size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("张三")])),_:1})])),_:1}),(0,t.Wm)(E,{label:"直播助理"},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,{size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("张三")])),_:1})])),_:1}),(0,t.Wm)(E,{label:"场控"},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,{size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("张三")])),_:1})])),_:1}),(0,t.Wm)(E,{label:"主播"},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,{size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("张三")])),_:1})])),_:1}),(0,t.Wm)(E,{label:"其他人员"},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,{size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("张三")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(B,{modelValue:e.dialogVisibleResult,"onUpdate:modelValue":a[8]||(a[8]=a=>e.dialogVisibleResult=a),title:"检测结果","close-on-press-escape":!1,"close-on-click-modal":!1,style:{width:"350px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(F,{data:e.imageUrlList,border:"",onSelectionChange:e.handleSelectionChange},{default:(0,t.w5)((()=>[(0,t.Wm)(j,{type:"selection",width:"40"}),(0,t.Wm)(j,{label:"查找对象",prop:"url",width:"120"},{default:(0,t.w5)((a=>[(0,t.Wm)(V,{src:"http://47.106.116.146:8080/profile"+a.row.url,alt:"Photo",fit:"contain",style:{"max-height":"120px","max-width":"70px"},"preview-teleported":!0,lazy:!0,"preview-src-list":e.imgPreview,onClick:l=>e.previewSrcList(a.row.url)},null,8,["src","preview-src-list","onClick"])])),_:1}),(0,t.Wm)(j,{label:"识别结果",prop:"matchUrl"},{default:(0,t.w5)((a=>[(0,t.Wm)(V,{src:"http://47.106.116.146:8080/profile"+a.row.matchUrl,alt:"Photo",fit:"contain",style:{"max-height":"120px","max-width":"70px"},"preview-teleported":!0,lazy:!0,"preview-src-list":e.imgPreview,onClick:l=>e.previewSrcList(a.row.matchUrl)},{error:(0,t.w5)((()=>[(0,t._)("i",b,(0,i.zw)(e.match_controll),1)])),_:2},1032,["src","preview-src-list","onClick"])])),_:1})])),_:1},8,["data","onSelectionChange"]),(0,t.Wm)(S,{type:"primary",style:{"margin-top":"15px"},onClick:e.ensureJade},{default:(0,t.w5)((()=>[(0,t.Uk)("确认")])),_:1},8,["onClick"]),_])),_:1},8,["modelValue"])])],64)}l(7658);var k=l(4870),y=l(7178),C=l(1836),U=l(2748),z=l(4161),S=l(5541),x=l(5941),D=(0,t.aZ)({name:"HomeView",components:{Plus:U.v37},setup(){const e=(0,k.iH)(null),a=(0,k.iH)(null),l=(0,k.iH)(null),i=(0,k.iH)(!1),r=(0,k.iH)(null),o=(0,k.iH)(!1),d=(0,k.iH)("识别中"),n=(0,k.iH)(!0),s=(0,k.iH)(!1),u=(0,k.iH)(""),m=(0,k.iH)([]),c=(0,k.iH)([]),p=(0,k.iH)(""),h=(0,k.iH)(!1),w=(0,k.iH)([]),g=(0,k.iH)([]),f=(0,k.qj)({jadeCode:"",lendCustom:"",storeNo:"",supplier:"",data:[],count:0}),v=(0,k.iH)([]),b=(0,k.qj)({clientId:[{required:!0,message:"出库客户不能为空",trigger:"change"}]}),_=(0,k.qj)({orderCode:"",jadeCode:"",lendCustom:"",clientId:"",inventoryType:3,deptId:"1"}),W=(0,k.qj)({data:[]}),U=(0,k.qj)({data:[]}),D=(0,k.qj)({data:[{label:"货品编码",prop:"jadeCode",width:"200",isdisabled:!0,isSelected:!0},{label:"入库单单号",prop:"orderCode",width:"200",isdisabled:!0,isSelected:!0},{label:"数量",prop:"jadeWeight",width:"60",isSelected:!0},{label:"成本价",prop:"jadeCode",width:"60",isSelected:!0},{label:"标签价",prop:"sellingPrice",Width:"60",isSelected:!1},{label:"供应商",prop:"supplierName",width:"70",isSelected:!0},{label:"货品状态",prop:"status",width:"70",isSelected:!0},{label:"客户名字",prop:"clientName",width:"70",isSelected:!1},{label:"入库仓库",prop:"warehouseId",width:"70",isSelected:!1},{label:"入库类型",prop:"inboundTypeName",width:"90",isdisabled:!0,isSelected:!0},{label:"入库人员",prop:"inboundPeople",width:"90",isdisabled:!0,isSelected:!0},{label:"入库时间",prop:"createTime",minWidth:"100",isdisabled:!0,isSelected:!0},{label:"备注",prop:"remark",minWidth:"80",maxWidth:"80",isSelected:!0},{label:"测试1",prop:"test1",minWidth:"80",maxWidth:"80",isSelected:!1},{label:"测试2",prop:"test2",minWidth:"80",maxWidth:"80",isSelected:!1}]});(0,t.wF)((()=>{u.value=(0,C.LP)(),(0,S.lE)().then((e=>{m.value=e.rows})),(0,S.OE)().then((e=>{_.orderCode=e}))})),(0,t.bv)((()=>{D.data.forEach((function(e,a){e.isSelected&&(U.data.push(e.label),W.data.push(e))}))}));const V=()=>{let e=[];D.data.forEach((a=>{U.data.forEach((l=>{a.label==l&&e.push(a)}))})),W.data=e},j=(0,k.qj)({data:{page:1,limit:10,total:v.value.length}}),H=()=>v.value,I=e=>{j.page=e},P=e=>{j.limit=e},F=()=>{const e=a.value,t=l.value;if(i.value){if(e)try{t.getContext("2d").drawImage(e,0,0,t.width,t.height),t.toBlob((e=>{const a=new FormData;a.append("file",e,"image.png"),z.Z.post("http://47.106.116.146:8080/common/uploadImage",a,{headers:{"Content-Type":"multipart/form-data",Authorization:u.value}}).then((e=>{(0,S.Bc)({image_path:e.data.url.slice(34)}).then((e=>{for(var a in e.result)c.value.push({id:a,url:e.result[a]});c.value.forEach((e=>{(0,S.B7)({imageId:e.id,imagePath:e.url}).then((()=>{(0,S.iF)({imageId:e.id}).then((a=>{"当前库存数量为0"==a.msg?d.value="查无此货，请核查":(e.matchId=a["best_match"][0],(0,S.Yp)(a["best_match"][0]).then((a=>{a.rows[0]?(e.matchUrl=a.rows[0].imageUrl,e.details=a.rows[0]):e.matchUrl=!1})))}))}))})),h.value=!0}))})).catch((e=>{x.error(e)}))}))}catch(r){x.log(r),y.z8.error("摄像头拍照失败")}}else y.z8.error("请先打开摄像头")},T=async()=>{i.value?(r.value.getTracks().forEach((e=>e.stop())),a.value.srcObject=null,i.value=!1):navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:!0}).then((e=>{r.value=e,a.value.srcObject=e,i.value=!0})).catch((e=>{x.log(e),y.z8.error("获取摄像头失败")})):y.z8.error("获取摄像头失败，请检查是否已连接摄像头")},E=e=>{e.forEach((e=>{x.log(e.details),g.value.push(e.details)}))},Z=()=>{try{v.value=g.value,g.value=[],c.value=[],h.value=!1}catch{y.z8.error("请检测完成后再勾选")}},O=e=>{(0,S.Bc)({image_path:e.url.slice(34)}).then((e=>{for(var a in e.result)c.value.push({id:a,url:e.result[a]});c.value.forEach((e=>{(0,S.B7)({imageId:e.id,imagePath:e.url}).then((()=>{(0,S.iF)({imageId:e.id}).then((a=>{e.matchId=a["best_match"][0],(0,S.Yp)(a["best_match"][0]).then((a=>{a.rows[0]?(e.matchUrl=a.rows[0].imageUrl,e.details=a.rows[0]):e.matchUrl=!1}))}))}))})),h.value=!0}))},B=e=>{w.value=[],w.value.push("http://47.106.116.146:8080/profile"+e)},R=e=>{x.log(e),_.inventoryShow1=_.inventoryShow2=_.inventoryShow3=!1,1==e?_.inventoryShow1=!0:2==e?_.inventoryShow2=!0:_.inventoryShow3=!0};return{inventoryJadeInfoData:v,token:u,imgPreview:w,imageUrlList:c,tempData:g,clientList:m,searchForm:f,inventoryForm:_,tableFilter:D,inventoryJadeDataColumn:W,selectedFilters:U,state:j,inventoryOrderRules:b,inventoryRef:e,match_controll:d,videoElement:a,canvasElement:l,isvideo:n,cameraActive:i,videoStream:r,dialogVisibleImg:s,dialogImageUrl:p,dialogVisibleDetails:o,dialogVisibleResult:h,tableData:H,handleCurrentChange:I,changeOutboundType:R,handleSizeChange:P,filterColumns:V,handleSelectionChange:E,ensureJade:Z,triggerCamera:T,handleUpload:O,previewSrcList:B,takePhoto:F,...(0,k.BK)(j)}}}),V=l(89);const j=(0,V.Z)(D,[["render",W],["__scopeId","data-v-61a42903"]]);var H=j}}]);
//# sourceMappingURL=919.0dc4396d.js.map