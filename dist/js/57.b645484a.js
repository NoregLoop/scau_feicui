(self["webpackChunkscau_ERP"]=self["webpackChunkscau_ERP"]||[]).push([[57],{6187:function(){},7057:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return w}});var a=t(3396),d=t(9242),o=t(7139);const i={class:"app-container"},r={"slot-scope":"scope"},s={"slot-scope":"scope"},n={"slot-scope":"scope"},p={slot:"footer",class:"dialog-footer"};function m(e,l,t,m,u,h){const c=(0,a.up)("el-input"),f=(0,a.up)("el-form-item"),w=(0,a.up)("el-option"),g=(0,a.up)("el-select"),_=(0,a.up)("el-button"),y=(0,a.up)("el-form"),b=(0,a.up)("el-col"),W=(0,a.up)("right-toolbar"),k=(0,a.up)("el-row"),v=(0,a.up)("el-table-column"),V=(0,a.up)("dict-tag"),I=(0,a.up)("el-table"),U=(0,a.up)("treeselect"),C=(0,a.up)("el-input-number"),N=(0,a.up)("el-radio"),x=(0,a.up)("el-radio-group"),q=(0,a.up)("el-dialog"),T=(0,a.Q2)("hasPermi"),z=(0,a.Q2)("loading");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a.wy)((0,a.Wm)(y,{model:u.queryParams,ref:"queryForm",size:"small",inline:!0},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{label:"部门名称",prop:"deptName"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{modelValue:u.queryParams.deptName,"onUpdate:modelValue":l[0]||(l[0]=e=>u.queryParams.deptName=e),placeholder:"请输入部门名称",clearable:"",onKeyup:(0,d.D2)(h.handleQuery,["enter","native"])},null,8,["modelValue","onKeyup"])])),_:1}),(0,a.Wm)(f,{label:"状态",prop:"status"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{modelValue:u.queryParams.status,"onUpdate:modelValue":l[1]||(l[1]=e=>u.queryParams.status=e),placeholder:"部门状态",clearable:""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.dict.type.sys_normal_disable,(e=>((0,a.wg)(),(0,a.j4)(w,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,{type:"primary",icon:"el-icon-search",size:"mini",onClick:h.handleQuery},{default:(0,a.w5)((()=>[(0,a.Uk)("搜索")])),_:1},8,["onClick"]),(0,a.Wm)(_,{icon:"el-icon-refresh",size:"mini",onClick:h.resetQuery},{default:(0,a.w5)((()=>[(0,a.Uk)("重置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"]),[[d.F8,u.showSearch]]),(0,a.Wm)(k,{gutter:10,class:"mb8"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{span:1.5},{default:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.j4)(_,{type:"primary",plain:"",icon:"el-icon-plus",size:"mini",onClick:h.handleAdd},{default:(0,a.w5)((()=>[(0,a.Uk)("新增")])),_:1},8,["onClick"])),[[T,["system:dept:add"]]])])),_:1}),(0,a.Wm)(b,{span:1.5},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{type:"info",plain:"",icon:"el-icon-sort",size:"mini",onClick:h.toggleExpandAll},{default:(0,a.w5)((()=>[(0,a.Uk)("展开/折叠")])),_:1},8,["onClick"])])),_:1}),(0,a.Wm)(W,{showSearch:u.showSearch,onQueryTable:h.getList},null,8,["showSearch","onQueryTable"])])),_:1}),u.refreshTable?(0,a.wy)(((0,a.wg)(),(0,a.j4)(I,{key:0,data:u.deptList,"row-key":"deptId","default-expand-all":u.isExpandAll,"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{prop:"deptName",label:"部门名称",width:"260"}),(0,a.Wm)(v,{prop:"orderNum",label:"排序",width:"200"}),(0,a.Wm)(v,{prop:"status",label:"状态",width:"100"},{default:(0,a.w5)((()=>[(0,a._)("template",r,[(0,a.Wm)(V,{options:e.dict.type.sys_normal_disable,value:e.scope.row.status},null,8,["options","value"])])])),_:1}),(0,a.Wm)(v,{label:"创建时间",align:"center",prop:"createTime",width:"200"},{default:(0,a.w5)((()=>[(0,a._)("template",s,[(0,a._)("span",null,(0,o.zw)(e.parseTime(e.scope.row.createTime)),1)])])),_:1}),(0,a.Wm)(v,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:(0,a.w5)((()=>[(0,a._)("template",n,[(0,a.wy)(((0,a.wg)(),(0,a.j4)(_,{size:"mini",type:"text",icon:"el-icon-edit",onClick:l[2]||(l[2]=l=>h.handleUpdate(e.scope.row))},{default:(0,a.w5)((()=>[(0,a.Uk)("修改")])),_:1})),[[T,["system:dept:edit"]]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(_,{size:"mini",type:"text",icon:"el-icon-plus",onClick:l[3]||(l[3]=l=>h.handleAdd(e.scope.row))},{default:(0,a.w5)((()=>[(0,a.Uk)("新增")])),_:1})),[[T,["system:dept:add"]]]),0!=e.scope.row.parentId?(0,a.wy)(((0,a.wg)(),(0,a.j4)(_,{key:0,size:"mini",type:"text",icon:"el-icon-delete",onClick:l[4]||(l[4]=l=>h.handleDelete(e.scope.row))},{default:(0,a.w5)((()=>[(0,a.Uk)("删除")])),_:1})),[[T,["system:dept:remove"]]]):(0,a.kq)("",!0)])])),_:1})])),_:1},8,["data","default-expand-all"])),[[z,u.loading]]):(0,a.kq)("",!0),(0,a.Wm)(q,{title:u.title,visible:u.open,width:"600px","append-to-body":""},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{ref:"form",model:u.form,rules:u.rules,"label-width":"80px"},{default:(0,a.w5)((()=>[(0,a.Wm)(k,null,{default:(0,a.w5)((()=>[0!==u.form.parentId?((0,a.wg)(),(0,a.j4)(b,{key:0,span:24},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{label:"上级部门",prop:"parentId"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{modelValue:u.form.parentId,"onUpdate:modelValue":l[5]||(l[5]=e=>u.form.parentId=e),options:u.deptOptions,normalizer:h.normalizer,placeholder:"选择上级部门"},null,8,["modelValue","options","normalizer"])])),_:1})])),_:1})):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(k,null,{default:(0,a.w5)((()=>[(0,a.Wm)(b,{span:12},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{label:"部门名称",prop:"deptName"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{modelValue:u.form.deptName,"onUpdate:modelValue":l[6]||(l[6]=e=>u.form.deptName=e),placeholder:"请输入部门名称"},null,8,["modelValue"])])),_:1})])),_:1}),(0,a.Wm)(b,{span:12},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{label:"显示排序",prop:"orderNum"},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{modelValue:u.form.orderNum,"onUpdate:modelValue":l[7]||(l[7]=e=>u.form.orderNum=e),"controls-position":"right",min:0},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(k,null,{default:(0,a.w5)((()=>[(0,a.Wm)(b,{span:12},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{label:"负责人",prop:"leader"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{modelValue:u.form.leader,"onUpdate:modelValue":l[8]||(l[8]=e=>u.form.leader=e),placeholder:"请输入负责人",maxlength:"20"},null,8,["modelValue"])])),_:1})])),_:1}),(0,a.Wm)(b,{span:12},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{label:"联系电话",prop:"phone"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{modelValue:u.form.phone,"onUpdate:modelValue":l[9]||(l[9]=e=>u.form.phone=e),placeholder:"请输入联系电话",maxlength:"11"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(k,null,{default:(0,a.w5)((()=>[(0,a.Wm)(b,{span:12},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{label:"邮箱",prop:"email"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{modelValue:u.form.email,"onUpdate:modelValue":l[10]||(l[10]=e=>u.form.email=e),placeholder:"请输入邮箱",maxlength:"50"},null,8,["modelValue"])])),_:1})])),_:1}),(0,a.Wm)(b,{span:12},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{label:"部门状态"},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{modelValue:u.form.status,"onUpdate:modelValue":l[11]||(l[11]=e=>u.form.status=e)},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.dict.type.sys_normal_disable,(e=>((0,a.wg)(),(0,a.j4)(N,{key:e.value,label:e.value},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"]),(0,a._)("div",p,[(0,a.Wm)(_,{type:"primary",onClick:h.submitForm},{default:(0,a.w5)((()=>[(0,a.Uk)("确 定")])),_:1},8,["onClick"]),(0,a.Wm)(_,{onClick:h.cancel},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1},8,["onClick"])])])),_:1},8,["title","visible"])])}t(7658);var u=t(6187),h={name:"Dept",dicts:["sys_normal_disable"],components:{Treeselect:Treeselect},data(){return{loading:!0,showSearch:!0,deptList:[],deptOptions:[],title:"",open:!1,isExpandAll:!0,refreshTable:!0,queryParams:{deptName:void 0,status:void 0},form:{},rules:{parentId:[{required:!0,message:"上级部门不能为空",trigger:"blur"}],deptName:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]}}},created(){this.getList()},methods:{getList(){this.loading=!0,(0,u.listDept)(this.queryParams).then((e=>{this.deptList=this.handleTree(e.data,"deptId"),this.loading=!1}))},normalizer(e){return e.children&&!e.children.length&&delete e.children,{id:e.deptId,label:e.deptName,children:e.children}},cancel(){this.open=!1,this.reset()},reset(){this.form={deptId:void 0,parentId:void 0,deptName:void 0,orderNum:void 0,leader:void 0,phone:void 0,email:void 0,status:"0"},this.resetForm("form")},handleQuery(){this.getList()},resetQuery(){this.resetForm("queryForm"),this.handleQuery()},handleAdd(e){this.reset(),void 0!=e&&(this.form.parentId=e.deptId),this.open=!0,this.title="添加部门",(0,u.listDept)().then((e=>{this.deptOptions=this.handleTree(e.data,"deptId")}))},toggleExpandAll(){this.refreshTable=!1,this.isExpandAll=!this.isExpandAll,this.$nextTick((()=>{this.refreshTable=!0}))},handleUpdate(e){this.reset(),(0,u.getDept)(e.deptId).then((l=>{this.form=l.data,this.open=!0,this.title="修改部门",(0,u.listDeptExcludeChild)(e.deptId).then((e=>{if(this.deptOptions=this.handleTree(e.data,"deptId"),0==this.deptOptions.length){const e={deptId:this.form.parentId,deptName:this.form.parentName,children:[]};this.deptOptions.push(e)}}))}))},submitForm:function(){this.$refs["form"].validate((e=>{e&&(void 0!=this.form.deptId?(0,u.updateDept)(this.form).then((e=>{this.$modal.msgSuccess("修改成功"),this.open=!1,this.getList()})):(0,u.addDept)(this.form).then((e=>{this.$modal.msgSuccess("新增成功"),this.open=!1,this.getList()})))}))},handleDelete(e){this.$modal.confirm('是否确认删除名称为"'+e.deptName+'"的数据项？').then((function(){return(0,u.delDept)(e.deptId)})).then((()=>{this.getList(),this.$modal.msgSuccess("删除成功")})).catch((()=>{}))}}},c=t(89);const f=(0,c.Z)(h,[["render",m]]);var w=f}}]);
//# sourceMappingURL=57.b645484a.js.map